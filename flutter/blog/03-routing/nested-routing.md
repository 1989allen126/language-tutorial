# ÂµåÂ•óË∑ØÁî±‰∏éÂ≠êË∑ØÁî±

> ÊûÑÂª∫Â§çÊùÇÁöÑÂ§öÂ±ÇÁ∫ßË∑ØÁî±ÁªìÊûÑÔºåÊîØÊåÅÂµåÂ•óÂØºËà™ÂíåÂ≠êÈ°µÈù¢ÁÆ°ÁêÜ

## üèóÔ∏è ÂµåÂ•óË∑ØÁî±Êû∂ÊûÑ

### Ë∑ØÁî±Â±ÇÊ¨°ÁªìÊûÑ

```mermaid
graph TB
    A[Ê†πË∑ØÁî±] --> B[‰∏ªÊ°ÜÊû∂]
    B --> C[Â∫ïÈÉ®ÂØºËà™]
    B --> D[‰æßËæπÊ†è]
    
    C --> E[È¶ñÈ°µË∑ØÁî±]
    C --> F[ÂàÜÁ±ªË∑ØÁî±]
    C --> G[Ë¥≠Áâ©ËΩ¶Ë∑ØÁî±]
    C --> H[‰∏™‰∫∫‰∏≠ÂøÉË∑ØÁî±]
    
    E --> I[ÂïÜÂìÅÂàóË°®]
    E --> J[ÂïÜÂìÅËØ¶ÊÉÖ]
    
    F --> K[ÂàÜÁ±ªÂàóË°®]
    F --> L[Â≠êÂàÜÁ±ª]
    F --> M[ÂïÜÂìÅÁ≠õÈÄâ]
    
    G --> N[Ë¥≠Áâ©ËΩ¶ÂàóË°®]
    G --> O[ÁªìÁÆóÈ°µÈù¢]
    
    H --> P[‰∏™‰∫∫‰ø°ÊÅØ]
    H --> Q[ËÆ¢ÂçïÂéÜÂè≤]
    H --> R[ËÆæÁΩÆÈ°µÈù¢]
    
    style A fill:#e1f5fe
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
```

### ÂµåÂ•óË∑ØÁî±ÊµÅÁ®ã

```mermaid
sequenceDiagram
    participant U as Áî®Êà∑
    participant R as Ê†πË∑ØÁî±Âô®
    participant S as ShellË∑ØÁî±
    participant C as Â≠êË∑ØÁî±Âô®
    participant P as È°µÈù¢
    
    U->>R: ËÆøÈóÆÂµåÂ•óË∑ØÁî±
    R->>S: ÂåπÈÖçShellË∑ØÁî±
    S->>C: ÂßîÊâòÁªôÂ≠êË∑ØÁî±Âô®
    C->>P: Ê∏≤ÊüìÁõÆÊ†áÈ°µÈù¢
    P->>C: È°µÈù¢Âä†ËΩΩÂÆåÊàê
    C->>S: ÈÄöÁü•Ê∏≤ÊüìÂÆåÊàê
    S->>R: Ë∑ØÁî±Ëß£ÊûêÂÆåÊàê
    R->>U: ÊòæÁ§∫ÂµåÂ•óÈ°µÈù¢
```

## üéØ Go Router ÂµåÂ•óÈÖçÁΩÆ

### Âü∫Á°ÄÂµåÂ•óË∑ØÁî±

```dart
// lib/core/routing/nested_router.dart
class NestedRouter {
  static final GoRouter router = GoRouter(
    initialLocation: '/home',
    routes: [
      // ShellË∑ØÁî± - ‰∏ªÊ°ÜÊû∂
      ShellRoute(
        builder: (context, state, child) {
          return MainShell(child: child);
        },
        routes: [
          // È¶ñÈ°µÂµåÂ•óË∑ØÁî±
          GoRoute(
            path: '/home',
            builder: (context, state) => const HomePage(),
            routes: [
              GoRoute(
                path: 'products/:categoryId',
                builder: (context, state) {
                  final categoryId = state.pathParameters['categoryId']!;
                  return ProductListPage(categoryId: categoryId);
                },
                routes: [
                  GoRoute(
                    path: 'detail/:productId',
                    builder: (context, state) {
                      final productId = state.pathParameters['productId']!;
                      final categoryId = state.pathParameters['categoryId']!;
                      return ProductDetailPage(
                        productId: productId,
                        categoryId: categoryId,
                      );
                    },
                  ),
                ],
              ),
            ],
          ),
          
          // ÂàÜÁ±ªÂµåÂ•óË∑ØÁî±
          GoRoute(
            path: '/category',
            builder: (context, state) => const CategoryPage(),
            routes: [
              GoRoute(
                path: ':categoryId',
                builder: (context, state) {
                  final categoryId = state.pathParameters['categoryId']!;
                  return CategoryDetailPage(categoryId: categoryId);
                },
                routes: [
                  GoRoute(
                    path: 'subcategory/:subId',
                    builder: (context, state) {
                      final categoryId = state.pathParameters['categoryId']!;
                      final subId = state.pathParameters['subId']!;
                      return SubCategoryPage(
                        categoryId: categoryId,
                        subCategoryId: subId,
                      );
                    },
                  ),
                ],
              ),
            ],
          ),
          
          // Ë¥≠Áâ©ËΩ¶ÂµåÂ•óË∑ØÁî±
          GoRoute(
            path: '/cart',
            builder: (context, state) => const CartPage(),
            routes: [
              GoRoute(
                path: 'checkout',
                builder: (context, state) => const CheckoutPage(),
                routes: [
                  GoRoute(
                    path: 'payment',
                    builder: (context, state) => const PaymentPage(),
                  ),
                  GoRoute(
                    path: 'confirmation',
                    builder: (context, state) => const OrderConfirmationPage(),
                  ),
                ],
              ),
            ],
          ),
          
          // ‰∏™‰∫∫‰∏≠ÂøÉÂµåÂ•óË∑ØÁî±
          GoRoute(
            path: '/profile',
            builder: (context, state) => const ProfilePage(),
            routes: [
              GoRoute(
                path: 'orders',
                builder: (context, state) => const OrderHistoryPage(),
                routes: [
                  GoRoute(
                    path: ':orderId',
                    builder: (context, state) {
                      final orderId = state.pathParameters['orderId']!;
                      return OrderDetailPage(orderId: orderId);
                    },
                  ),
                ],
              ),
              GoRoute(
                path: 'settings',
                builder: (context, state) => const SettingsPage(),
                routes: [
                  GoRoute(
                    path: 'account',
                    builder: (context, state) => const AccountSettingsPage(),
                  ),
                  GoRoute(
                    path: 'privacy',
                    builder: (context, state) => const PrivacySettingsPage(),
                  ),
                  GoRoute(
                    path: 'notifications',
                    builder: (context, state) => const NotificationSettingsPage(),
                  ),
                ],
              ),
            ],
          ),
        ],
      ),
      
      // Áã¨Á´ãË∑ØÁî±Ôºà‰∏çÂú®Shell‰∏≠Ôºâ
      GoRoute(
        path: '/login',
        builder: (context, state) => const LoginPage(),
      ),
      GoRoute(
        path: '/register',
        builder: (context, state) => const RegisterPage(),
      ),
    ],
  );
}
```

### ‰∏ªÊ°ÜÊû∂ShellÂÆûÁé∞

```dart
// lib/widgets/shells/main_shell.dart
class MainShell extends StatefulWidget {
  final Widget child;
  
  const MainShell({super.key, required this.child});
  
  @override
  State<MainShell> createState() => _MainShellState();
}

class _MainShellState extends State<MainShell> {
  int _currentIndex = 0;
  
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: widget.child,
      bottomNavigationBar: BottomNavigationBar(
        type: BottomNavigationBarType.fixed,
        currentIndex: _getCurrentIndex(context),
        onTap: _onTabTapped,
        items: const [
          BottomNavigationBarItem(
            icon: Icon(Icons.home),
            label: 'È¶ñÈ°µ',
          ),
          BottomNavigationBarItem(
            icon: Icon(Icons.category),
            label: 'ÂàÜÁ±ª',
          ),
          BottomNavigationBarItem(
            icon: Icon(Icons.shopping_cart),
            label: 'Ë¥≠Áâ©ËΩ¶',
          ),
          BottomNavigationBarItem(
            icon: Icon(Icons.person),
            label: 'ÊàëÁöÑ',
          ),
        ],
      ),
    );
  }
  
  int _getCurrentIndex(BuildContext context) {
    final location = GoRouterState.of(context).location;
    
    if (location.startsWith('/home')) return 0;
    if (location.startsWith('/category')) return 1;
    if (location.startsWith('/cart')) return 2;
    if (location.startsWith('/profile')) return 3;
    
    return 0;
  }
  
  void _onTabTapped(int index) {
    switch (index) {
      case 0:
        context.go('/home');
        break;
      case 1:
        context.go('/category');
        break;
      case 2:
        context.go('/cart');
        break;
      case 3:
        context.go('/profile');
        break;
    }
  }
}
```

## üîÑ Â§öÁ∫ßÂµåÂ•óË∑ØÁî±

### Â§çÊùÇÂµåÂ•óÁªìÊûÑ

```dart
// lib/core/routing/complex_nested_router.dart
class ComplexNestedRouter {
  static final GoRouter router = GoRouter(
    routes: [
      // ‰∏ªÂ∫îÁî®Shell
      ShellRoute(
        builder: (context, state, child) => AppShell(child: child),
        routes: [
          // Â∑•‰ΩúÂè∞Shell
          ShellRoute(
            builder: (context, state, child) => WorkspaceShell(child: child),
            routes: [
              GoRoute(
                path: '/workspace',
                builder: (context, state) => const WorkspacePage(),
                routes: [
                  // È°πÁõÆÁÆ°ÁêÜÂµåÂ•ó
                  GoRoute(
                    path: 'projects',
                    builder: (context, state) => const ProjectsPage(),
                    routes: [
                      GoRoute(
                        path: ':projectId',
                        builder: (context, state) {
                          final projectId = state.pathParameters['projectId']!;
                          return ProjectDetailPage(projectId: projectId);
                        },
                        routes: [
                          // ‰ªªÂä°ÁÆ°ÁêÜÂµåÂ•ó
                          GoRoute(
                            path: 'tasks',
                            builder: (context, state) {
                              final projectId = state.pathParameters['projectId']!;
                              return TasksPage(projectId: projectId);
                            },
                            routes: [
                              GoRoute(
                                path: ':taskId',
                                builder: (context, state) {
                                  final projectId = state.pathParameters['projectId']!;
                                  final taskId = state.pathParameters['taskId']!;
                                  return TaskDetailPage(
                                    projectId: projectId,
                                    taskId: taskId,
                                  );
                                },
                                routes: [
                                  // Â≠ê‰ªªÂä°ÂµåÂ•ó
                                  GoRoute(
                                    path: 'subtasks/:subtaskId',
                                    builder: (context, state) {
                                      final projectId = state.pathParameters['projectId']!;
                                      final taskId = state.pathParameters['taskId']!;
                                      final subtaskId = state.pathParameters['subtaskId']!;
                                      return SubtaskDetailPage(
                                        projectId: projectId,
                                        taskId: taskId,
                                        subtaskId: subtaskId,
                                      );
                                    },
                                  ),
                                ],
                              ),
                            ],
                          ),
                          // Êñá‰ª∂ÁÆ°ÁêÜÂµåÂ•ó
                          GoRoute(
                            path: 'files',
                            builder: (context, state) {
                              final projectId = state.pathParameters['projectId']!;
                              return FilesPage(projectId: projectId);
                            },
                            routes: [
                              GoRoute(
                                path: 'folder/:folderId',
                                builder: (context, state) {
                                  final projectId = state.pathParameters['projectId']!;
                                  final folderId = state.pathParameters['folderId']!;
                                  return FolderPage(
                                    projectId: projectId,
                                    folderId: folderId,
                                  );
                                },
                              ),
                            ],
                          ),
                        ],
                      ),
                    ],
                  ),
                ],
              ),
            ],
          ),
        ],
      ),
    ],
  );
}
```

### ÂµåÂ•óË∑ØÁî±Áä∂ÊÄÅÁÆ°ÁêÜ

```dart
// lib/core/routing/nested_route_state.dart
class NestedRouteState extends ChangeNotifier {
  final Map<String, dynamic> _routeData = {};
  final Map<String, ScrollController> _scrollControllers = {};
  
  // ‰øùÂ≠òË∑ØÁî±Êï∞ÊçÆ
  void setRouteData(String routePath, dynamic data) {
    _routeData[routePath] = data;
    notifyListeners();
  }
  
  // Ëé∑ÂèñË∑ØÁî±Êï∞ÊçÆ
  T? getRouteData<T>(String routePath) {
    return _routeData[routePath] as T?;
  }
  
  // Ê∏ÖÈô§Ë∑ØÁî±Êï∞ÊçÆ
  void clearRouteData(String routePath) {
    _routeData.remove(routePath);
    notifyListeners();
  }
  
  // Ëé∑ÂèñÊªöÂä®ÊéßÂà∂Âô®
  ScrollController getScrollController(String routePath) {
    return _scrollControllers.putIfAbsent(
      routePath,
      () => ScrollController(),
    );
  }
  
  // ‰øùÂ≠òÊªöÂä®‰ΩçÁΩÆ
  void saveScrollPosition(String routePath) {
    final controller = _scrollControllers[routePath];
    if (controller != null && controller.hasClients) {
      setRouteData('${routePath}_scroll', controller.offset);
    }
  }
  
  // ÊÅ¢Â§çÊªöÂä®‰ΩçÁΩÆ
  void restoreScrollPosition(String routePath) {
    final controller = _scrollControllers[routePath];
    final savedOffset = getRouteData<double>('${routePath}_scroll');
    
    if (controller != null && savedOffset != null) {
      WidgetsBinding.instance.addPostFrameCallback((_) {
        if (controller.hasClients) {
          controller.jumpTo(savedOffset);
        }
      });
    }
  }
  
  @override
  void dispose() {
    for (final controller in _scrollControllers.values) {
      controller.dispose();
    }
    super.dispose();
  }
}
```

## üé® ÂµåÂ•óÂØºËà™ÁªÑ‰ª∂

### Èù¢ÂåÖÂ±ëÂØºËà™

```dart
// lib/widgets/navigation/breadcrumb_navigation.dart
class BreadcrumbNavigation extends StatelessWidget {
  final List<BreadcrumbItem> items;
  final VoidCallback? onHomeTap;
  
  const BreadcrumbNavigation({
    super.key,
    required this.items,
    this.onHomeTap,
  });
  
  @override
  Widget build(BuildContext context) {
    return Container(
      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),
      child: Row(
        children: [
          if (onHomeTap != null)
            GestureDetector(
              onTap: onHomeTap,
              child: const Icon(Icons.home, size: 20),
            ),
          if (onHomeTap != null)
            const SizedBox(width: 8),
          Expanded(
            child: SingleChildScrollView(
              scrollDirection: Axis.horizontal,
              child: Row(
                children: _buildBreadcrumbItems(context),
              ),
            ),
          ),
        ],
      ),
    );
  }
  
  List<Widget> _buildBreadcrumbItems(BuildContext context) {
    final widgets = <Widget>[];
    
    for (int i = 0; i < items.length; i++) {
      final item = items[i];
      final isLast = i == items.length - 1;
      
      // Ê∑ªÂä†Èù¢ÂåÖÂ±ëÈ°π
      widgets.add(
        GestureDetector(
          onTap: isLast ? null : item.onTap,
          child: Text(
            item.title,
            style: TextStyle(
              color: isLast 
                  ? Theme.of(context).textTheme.bodyLarge?.color
                  : Theme.of(context).primaryColor,
              fontWeight: isLast ? FontWeight.bold : FontWeight.normal,
            ),
          ),
        ),
      );
      
      // Ê∑ªÂä†ÂàÜÈöîÁ¨¶
      if (!isLast) {
        widgets.add(
          const Padding(
            padding: EdgeInsets.symmetric(horizontal: 8),
            child: Icon(Icons.chevron_right, size: 16),
          ),
        );
      }
    }
    
    return widgets;
  }
}

class BreadcrumbItem {
  final String title;
  final VoidCallback? onTap;
  
  const BreadcrumbItem({
    required this.title,
    this.onTap,
  });
}
```

### ‰æßËæπÊ†èÂØºËà™

```dart
// lib/widgets/navigation/sidebar_navigation.dart
class SidebarNavigation extends StatefulWidget {
  final List<NavigationItem> items;
  final String? currentPath;
  final ValueChanged<String>? onItemTap;
  
  const SidebarNavigation({
    super.key,
    required this.items,
    this.currentPath,
    this.onItemTap,
  });
  
  @override
  State<SidebarNavigation> createState() => _SidebarNavigationState();
}

class _SidebarNavigationState extends State<SidebarNavigation> {
  final Set<String> _expandedItems = {};
  
  @override
  Widget build(BuildContext context) {
    return Container(
      width: 250,
      decoration: BoxDecoration(
        color: Theme.of(context).cardColor,
        border: Border(
          right: BorderSide(
            color: Theme.of(context).dividerColor,
            width: 1,
          ),
        ),
      ),
      child: ListView(
        children: widget.items.map(_buildNavigationItem).toList(),
      ),
    );
  }
  
  Widget _buildNavigationItem(NavigationItem item) {
    final isSelected = widget.currentPath?.startsWith(item.path) ?? false;
    final hasChildren = item.children.isNotEmpty;
    final isExpanded = _expandedItems.contains(item.path);
    
    return Column(
      children: [
        ListTile(
          leading: Icon(item.icon),
          title: Text(item.title),
          trailing: hasChildren
              ? Icon(
                  isExpanded ? Icons.expand_less : Icons.expand_more,
                )
              : null,
          selected: isSelected,
          onTap: () {
            if (hasChildren) {
              setState(() {
                if (isExpanded) {
                  _expandedItems.remove(item.path);
                } else {
                  _expandedItems.add(item.path);
                }
              });
            } else {
              widget.onItemTap?.call(item.path);
            }
          },
        ),
        if (hasChildren && isExpanded)
          ...item.children.map(
            (child) => Padding(
              padding: const EdgeInsets.only(left: 32),
              child: _buildNavigationItem(child),
            ),
          ),
      ],
    );
  }
}

class NavigationItem {
  final String title;
  final String path;
  final IconData icon;
  final List<NavigationItem> children;
  
  const NavigationItem({
    required this.title,
    required this.path,
    required this.icon,
    this.children = const [],
  });
}
```

## üîß Ë∑ØÁî±ÂèÇÊï∞‰º†ÈÄí

### ÂµåÂ•óË∑ØÁî±ÂèÇÊï∞ÁÆ°ÁêÜ

```dart
// lib/core/routing/nested_route_params.dart
class NestedRouteParams {
  static Map<String, String> extractParams(GoRouterState state) {
    final params = <String, String>{};
    
    // ÊèêÂèñË∑ØÂæÑÂèÇÊï∞
    params.addAll(state.pathParameters);
    
    // ÊèêÂèñÊü•ËØ¢ÂèÇÊï∞
    params.addAll(state.uri.queryParameters);
    
    return params;
  }
  
  // ÊûÑÂª∫ÂµåÂ•óË∑ØÁî±Ë∑ØÂæÑ
  static String buildNestedPath({
    required String basePath,
    required Map<String, String> pathParams,
    Map<String, String>? queryParams,
  }) {
    String path = basePath;
    
    // ÊõøÊç¢Ë∑ØÂæÑÂèÇÊï∞
    pathParams.forEach((key, value) {
      path = path.replaceAll(':$key', value);
    });
    
    // Ê∑ªÂä†Êü•ËØ¢ÂèÇÊï∞
    if (queryParams != null && queryParams.isNotEmpty) {
      final query = queryParams.entries
          .map((e) => '${e.key}=${Uri.encodeComponent(e.value)}')
          .join('&');
      path += '?$query';
    }
    
    return path;
  }
  
  // È™åËØÅÂøÖÈúÄÂèÇÊï∞
  static bool validateRequiredParams(
    Map<String, String> params,
    List<String> requiredParams,
  ) {
    for (final param in requiredParams) {
      if (!params.containsKey(param) || params[param]!.isEmpty) {
        return false;
      }
    }
    return true;
  }
}
```

### Á±ªÂûãÂÆâÂÖ®ÁöÑË∑ØÁî±ÂèÇÊï∞

```dart
// lib/core/routing/typed_route_params.dart
abstract class TypedRouteParams {
  Map<String, String> toPathParams();
  Map<String, String> toQueryParams();
}

class ProductRouteParams extends TypedRouteParams {
  final String categoryId;
  final String productId;
  final String? variant;
  final int? quantity;
  
  const ProductRouteParams({
    required this.categoryId,
    required this.productId,
    this.variant,
    this.quantity,
  });
  
  factory ProductRouteParams.fromState(GoRouterState state) {
    return ProductRouteParams(
      categoryId: state.pathParameters['categoryId']!,
      productId: state.pathParameters['productId']!,
      variant: state.uri.queryParameters['variant'],
      quantity: int.tryParse(state.uri.queryParameters['quantity'] ?? ''),
    );
  }
  
  @override
  Map<String, String> toPathParams() {
    return {
      'categoryId': categoryId,
      'productId': productId,
    };
  }
  
  @override
  Map<String, String> toQueryParams() {
    final params = <String, String>{};
    
    if (variant != null) params['variant'] = variant!;
    if (quantity != null) params['quantity'] = quantity.toString();
    
    return params;
  }
  
  String toPath() {
    return NestedRouteParams.buildNestedPath(
      basePath: '/home/products/:categoryId/detail/:productId',
      pathParams: toPathParams(),
      queryParams: toQueryParams(),
    );
  }
}
```

## üß™ ÂµåÂ•óË∑ØÁî±ÊµãËØï

### ÂµåÂ•óË∑ØÁî±ÊµãËØïÂ∑•ÂÖ∑

```dart
// test/routing/nested_routing_test_helper.dart
class NestedRoutingTestHelper {
  static Future<void> testNestedNavigation(
    WidgetTester tester,
    List<String> navigationPath,
  ) async {
    // ÊûÑÂª∫Â∫îÁî®
    await tester.pumpWidget(
      MaterialApp.router(
        routerConfig: NestedRouter.router,
      ),
    );
    
    // ÈÄêÊ≠•ÂØºËà™Âà∞ÂµåÂ•óË∑ØÁî±
    for (final path in navigationPath) {
      NestedRouter.router.go(path);
      await tester.pumpAndSettle();
      
      // È™åËØÅË∑ØÁî±Áä∂ÊÄÅ
      expect(
        NestedRouter.router.routerDelegate.currentConfiguration.location,
        equals(path),
      );
    }
  }
  
  static Future<void> testBreadcrumbNavigation(
    WidgetTester tester,
    String deepPath,
  ) async {
    // ÂØºËà™Âà∞Ê∑±Â±ÇË∑ØÁî±
    NestedRouter.router.go(deepPath);
    await tester.pumpAndSettle();
    
    // Êü•ÊâæÈù¢ÂåÖÂ±ëÂØºËà™
    final breadcrumb = find.byType(BreadcrumbNavigation);
    expect(breadcrumb, findsOneWidget);
    
    // ÊµãËØïÈù¢ÂåÖÂ±ëÁÇπÂáª
    final breadcrumbItems = find.descendant(
      of: breadcrumb,
      matching: find.byType(GestureDetector),
    );
    
    if (breadcrumbItems.evaluate().length > 1) {
      await tester.tap(breadcrumbItems.first);
      await tester.pumpAndSettle();
      
      // È™åËØÅÂØºËà™ÂõûÂà∞‰∏äÁ∫ßË∑ØÁî±
      expect(
        NestedRouter.router.routerDelegate.currentConfiguration.location,
        isNot(equals(deepPath)),
      );
    }
  }
}
```

### ÂµåÂ•óË∑ØÁî±ÂçïÂÖÉÊµãËØï

```dart
// test/routing/nested_routing_test.dart
void main() {
  group('Nested Routing', () {
    testWidgets('navigates through nested routes correctly', (tester) async {
      await NestedRoutingTestHelper.testNestedNavigation(
        tester,
        [
          '/home',
          '/home/products/electronics',
          '/home/products/electronics/detail/phone123',
        ],
      );
    });
    
    testWidgets('breadcrumb navigation works', (tester) async {
      await NestedRoutingTestHelper.testBreadcrumbNavigation(
        tester,
        '/home/products/electronics/detail/phone123',
      );
    });
    
    testWidgets('preserves state in nested routes', (tester) async {
      // ÊµãËØïÂµåÂ•óË∑ØÁî±Áä∂ÊÄÅ‰øùÊåÅ
      await tester.pumpWidget(
        MaterialApp.router(
          routerConfig: NestedRouter.router,
        ),
      );
      
      // ÂØºËà™Âà∞ÂàóË°®È°µÈù¢
      NestedRouter.router.go('/home/products/electronics');
      await tester.pumpAndSettle();
      
      // ÊªöÂä®ÂàóË°®
      final listView = find.byType(ListView);
      await tester.drag(listView, const Offset(0, -200));
      await tester.pumpAndSettle();
      
      // ÂØºËà™Âà∞ËØ¶ÊÉÖÈ°µÈù¢
      NestedRouter.router.go('/home/products/electronics/detail/phone123');
      await tester.pumpAndSettle();
      
      // ËøîÂõûÂàóË°®È°µÈù¢
      NestedRouter.router.go('/home/products/electronics');
      await tester.pumpAndSettle();
      
      // È™åËØÅÊªöÂä®‰ΩçÁΩÆÊòØÂê¶‰øùÊåÅ
      final scrollController = find.byType(ListView).evaluate().first.widget as ListView;
      // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†Êõ¥ÂÖ∑‰ΩìÁöÑÊªöÂä®‰ΩçÁΩÆÈ™åËØÅ
    });
  });
}
```

## üìö ÊúÄ‰Ω≥ÂÆûË∑µ

### ÂµåÂ•óË∑ØÁî±ËÆæËÆ°ÂéüÂàô

1. **Â±ÇÊ¨°Ê∏ÖÊô∞**
   - Ë∑ØÁî±Â±ÇÊ¨°‰∏çË∂ÖËøá4Â±Ç
   - ÊØèÂ±ÇË∑ØÁî±ËÅåË¥£ÊòéÁ°Æ
   - ÈÅøÂÖçËøáÂ∫¶ÂµåÂ•ó

2. **Áä∂ÊÄÅÁÆ°ÁêÜ**
   - ÂêàÁêÜ‰øùÂ≠òÈ°µÈù¢Áä∂ÊÄÅ
   - ÂèäÊó∂Ê∏ÖÁêÜÊó†Áî®Áä∂ÊÄÅ
   - ‰ΩøÁî®ProviderÁÆ°ÁêÜÂÖ±‰∫´Áä∂ÊÄÅ

3. **ÊÄßËÉΩ‰ºòÂåñ**
   - ÊáíÂä†ËΩΩÂµåÂ•óÈ°µÈù¢
   - ÂêàÁêÜ‰ΩøÁî®ShellË∑ØÁî±
   - ÈÅøÂÖç‰∏çÂøÖË¶ÅÁöÑÈáçÂª∫

### ÂµåÂ•óË∑ØÁî±ÈÖçÁΩÆÂª∫ËÆÆ

```dart
// lib/core/routing/nested_route_config.dart
class NestedRouteConfig {
  // Êé®ËçêÁöÑÂµåÂ•óÊ∑±Â∫¶
  static const int maxNestingDepth = 4;
  
  // ShellË∑ØÁî±ÈÖçÁΩÆ
  static const List<String> shellRoutes = [
    '/home',
    '/category',
    '/cart',
    '/profile',
  ];
  
  // ÈúÄË¶Å‰øùÊåÅÁä∂ÊÄÅÁöÑË∑ØÁî±
  static const List<String> statefulRoutes = [
    '/home/products',
    '/category',
    '/cart',
  ];
  
  // È™åËØÅË∑ØÁî±ÈÖçÁΩÆ
  static bool validateRouteConfig(List<GoRoute> routes) {
    for (final route in routes) {
      if (_getRouteDepth(route.path) > maxNestingDepth) {
        return false;
      }
    }
    return true;
  }
  
  static int _getRouteDepth(String path) {
    return path.split('/').where((segment) => segment.isNotEmpty).length;
  }
}
```

## üîó Áõ∏ÂÖ≥ËµÑÊ∫ê

- [Go Router Nested Routes](https://pub.dev/packages/go_router)
- [Flutter Navigation 2.0](https://flutter.dev/docs/development/ui/navigation)
- [Nested Navigation Best Practices](https://docs.flutter.dev/cookbook/navigation)
- [Shell Routes Documentation](https://pub.dev/documentation/go_router/latest/)